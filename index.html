<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Zaporium Key</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;五百&display=swap');
        body{margin:0;height:100vh;background:#000;color:#fff;font-family:'Orbitron',sans-serif;display:flex;align-items:center;justify-content:center;overflow:hidden}
        .container{background:#111;padding:40px 20px;border-radius:8px;border:1px solid #333;text-align:center;max-width:90%;box-sizing:border-box}
        h1{font-size:2rem;margin:0 0 10px;font-weight:500}
        .subtitle{color:#ccc;margin-bottom:30px;font-size:1rem}
        .key-box{background:#222;padding:15px;border:1px solid #444;border-radius:4px;margin:20px 0;font-size:1.2rem;letter-spacing:1px;word-break:break-all;color:#fff}
        .copy-btn{background:#007bff;color:#fff;border:none;padding:12px 30px;font-size:1rem;border-radius:4px;cursor:pointer;margin:10px;transition:.3s}
        .copy-btn:hover{background:#0056b3}
        .continue-btn{background:#444;color:#888;border:none;padding:15px 40px;font-size:1.2rem;border-radius:4px;cursor:not-allowed;margin:20px auto;display:block;width:80%;max-width:300px;transition:.3s}
        .continue-btn.active{background:#fff;color:#000;cursor:pointer;font-weight:bold}
        .timer{color:#fff;font-size:1.1rem;margin:15px 0;font-weight:bold}
        .hidden{display:none}
        #notify{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:#007bff;color:#fff;padding:12px 25px;border-radius:6px;z-index:9999;opacity:0;transition:opacity .4s}
        #notify.show{opacity:1}
    </style>
</head>
<body>
    <div class="container">
        <h1>ZAPORIUM</h1>
        <p class="subtitle">Exclusive Access Key System</p>

        <div id="continueScreen">
            <p style="color:#aaa;font-size:0.9rem;line-height:1.4;margin:20px 0;">
                Click continue after the timer.<br>Ads may appear — they support the project.
            </p>
            <button class="continue-btn" id="continueBtn" disabled>Continue (<span id="countdown">5</span>s)</button>
        </div>

        <div id="keyScreen" class="hidden">
            <div id="keyDisplay" class="key-box">ZAP-XXXXX-XXXXX-XXXXX</div>
            <button class="copy-btn" id="copyBtn" onclick="copyKey()">COPY KEY</button>
            <div class="timer" id="timer">Time left: 23:59:59</div>
            <p style="color:#aaa;margin:15px 0;">Valid for 24 hours • Do not share</p>
        </div>

        <div id="notify">Key copied!</div>
    </div>

    <script>
        const LOOT_LINK = "https://lootdest.org/s?ZS40VyJq"; // ← change to your real shortener
        const KEYS_URL = "https://raw.githubusercontent.com/cheyt2025-cyber/Keysystem/main/keys.json";
        const STORAGE_KEY = "zaporium_data_v2";
        const DURATION = 24 * 60 * 60 * 1000;
        let ALL_KEYS = [];

        async function loadKeys() {
            try {
                const res = await fetch(KEYS_URL + "?t=" + Date.now()); // cache buster
                ALL_KEYS = await res.json();
            } catch(e) {
                alert("Failed to load keys! Check internet or contact owner.");
            }
        }

        function saveData(d) { localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }
        function loadData() { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); }
        function formatTime(ms) {
            let h = String(Math.floor(ms / 3600000)).padStart(2, "0");
            let m = String(Math.floor((ms % 3600000) / 60000)).padStart(2, "0");
            let s = String(Math.floor((ms % 60000) / 1000)).padStart(2, "0");
            return `${h}:${m}:${s}`;
        }
        function copyKey() {
            navigator.clipboard.writeText(document.getElementById("keyDisplay").textContent);
            const n = document.getElementById("notify"); n.classList.add("show");
            setTimeout(() => n.classList.remove("show"), 2000);
            document.getElementById("copyBtn").textContent = "Copied!";
        }
        function showKeyScreen(key) {
            document.getElementById("continueScreen").classList.add("hidden");
            document.getElementById("keyScreen").classList.remove("hidden");
            document.getElementById("keyDisplay").textContent = key;
            const data = loadData();
            const start = data.generationTime || Date.now();
            function tick() {
                const left = DURATION - (Date.now() - start);
                if (left <= 0) { localStorage.removeItem(STORAGE_KEY); location.reload(); return; }
                document.getElementById("timer").textContent = "Time left: " + formatTime(left);
            }
            tick(); setInterval(tick, 1000);
        }
        function generateKey() {
            const data = loadData();
            if (data.key && data.generationTime && (Date.now() - data.generationTime < DURATION)) {
                showKeyScreen(data.key);
                return;
            }
            let used = data.usedKeys || [];
            const available = ALL_KEYS.filter(k => !used.includes(k));
            if (available.length === 0) { alert("All keys claimed! Contact owner."); return; }
            const newKey = available[Math.floor(Math.random() * available.length)];
            used.push(newKey);
            saveData({ key: newKey, generationTime: Date.now(), usedKeys: used });
            showKeyScreen(newKey);
        }
        function startCountdown() {
            let s = 5;
            const btn = document.getElementById("continueBtn");
            const counter = document.getElementById("countdown");
            const timer = setInterval(() => {
                s--;
                counter.textContent = s;
                if (s <= 0) {
                    clearInterval(timer);
                    btn.classList.add("active");
                    btn.disabled = false;
                    btn.textContent = "Continue →";
                }
            }, 1000);
        }

        window.addEventListener("load", async () => {
            await loadKeys(); // ← load keys from keys.json first
            const url = new URL(window.location.href);
            const data = loadData();

            if (url.searchParams.get("reward") === "1") {
                history.replaceState(null, "", location.pathname);
                generateKey();
                return;
            }

            if (data.key && data.generationTime && (Date.now() - data.generationTime < DURATION)) {
                showKeyScreen(data.key);
                return;
            }

            startCountdown();
            document.getElementById("continueBtn").onclick = () => {
                window.open(LOOT_LINK, "_blank");
            };
        });
    </script>
</body>
</html>
